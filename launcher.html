<!DOCTYPE html>
<html>
<head>
  <title>Alpha Token Launcher</title>
</head>
<body style="font-family: sans-serif; padding: 40px; background: #111; color: white;">
  <h1>üöÄ Launch a Token</h1>
  <form id="launchForm">
    <label>Name:</label><br>
    <input type="text" name="name" value="Chill Baby"><br><br>

    <label>Ticker:</label><br>
    <input type="text" name="ticker" value="CHILL"><br><br>

    <label>Image Prompt:</label><br>
    <input type="text" name="imagePrompt" value="cool baby meme"><br><br>

    <label>Description:</label><br>
    <input type="text" name="description" value="The chillest token on Solana üòé"><br><br>

    <button type="submit">üöÄ Launch</button>
  </form>

  <p id="response"></p>

  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@latest/lib/index.iife.js"></script>
  <script>
    const FEE_DESTINATION = "FEE_DESTINATION_PLACEHOLDER";
    const FEE_AMOUNT = 0.1;

    document.getElementById("launchForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const provider = window.solana;
      if (!provider?.isPhantom) {
        alert("Phantom wallet not found");
        return;
      }

      await provider.connect();

      const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com");
      const transaction = new solanaWeb3.Transaction().add(
        solanaWeb3.SystemProgram.transfer({
          fromPubkey: provider.publicKey,
          toPubkey: new solanaWeb3.PublicKey(FEE_DESTINATION),
          lamports: FEE_AMOUNT * solanaWeb3.LAMPORTS_PER_SOL,
        })
      );
      transaction.feePayer = provider.publicKey;
      transaction.recentBlockhash = (await connection.getLatestBlockhash()).blockhash;
      const signed = await provider.signAndSendTransaction(transaction);

      const form = e.target;
      const data = {
        name: form.name.value,
        ticker: form.ticker.value,
        imagePrompt: form.imagePrompt.value,
        description: form.description.value,
        txSignature: signed.signature
      };

      const res = await fetch("http://localhost:3001/launch", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const json = await res.json();
      document.getElementById("response").innerHTML = json.success
        ? `‚úÖ <a href="${json.url}" target="_blank">View Token Page</a>\nToken: ${json.tokenAddress}`
        : `‚ùå ${json.message}`;
    });
  </script>
</body>
</html>
